Nowadays, the Internet of Things (IoT) offers a variety of solutions to control industrial environments. In the new IoT generation, including millions of machines and huge traffic volumes, two important issues have challenged the network: achieving the Quality of Service (QoS) and avoiding overload. The IoT has diverse classes of applications, the traffic of which requires a special QoS. Meanwhile, the IoT has servers among which traffic should be distributed according to their available capacity. In this paper, we propose a novel framework based on Software-defined Networking (SDN) to fulfill the QoS requirements of various IoT services and to balance traffic between IoT servers simultaneously. Hence, we first formulate the problem as an Integer Linear Programming (ILP) model that is NP-hard. We then propose a predictive and proactive heuristic mechanism based on time-series analysis and fuzzy logic. Afterwards, we implement the proposed framework in a real testbed including the Open vSwitch, Floodlight controller, and Kaa servers. To evaluate the performance, we conduct various experiments under different scenarios, indicating firstly the improved IoT QoS parameters, including throughput and delay, and secondly the non-occurrence of overload on IoT servers in heavy traffic. Also, the results show improved performance compared to similar methods. 
